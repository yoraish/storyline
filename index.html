<!DOCTYPE html>
<html>

<script>
    function put_new_line() {

        // Puts new line into the text part of the json file.
        // Puts new line into the last_line of the json file.

        var new_line = document.getElementById("input_form").elements["new_line_input"].value;
        // Send the HTTP GET request
        const Http = new XMLHttpRequest();
        const url = `https://yorai.scripts.mit.edu/storyline/storyline.py?command=add&line=${new_line}`;
        Http.open("GET", url);
        Http.send();

        Http.onreadystatechange = (e) => {
            var response_text = Http.responseText;
            console.log("Response from command \"add\" %s", response_text);
            document.getElementById("print_last_line").innerHTML =
                response_text;

            // Just write that the line was submitted
            document.getElementById("print_new_line").innerHTML = "Succesfully submitted line: \"" + response_text + "\" ";
        }
    }
</script>


<script>
    function get_last_line() {
        const Http = new XMLHttpRequest();
        const url = 'https://yorai.scripts.mit.edu/storyline/storyline.py?command=get';
        Http.open("GET", url);
        Http.send();

        Http.onreadystatechange = (e) => {
            var response_text = Http.responseText;
            console.log("Response from command \"get\" %s", response_text);
            document.getElementById("print_last_line").innerHTML =
                response_text;
        }
    }
</script>


<body bgcolor="#624050">


    <h1 style="color:blanchedalmond;">Welcome to Storyline</h1>
    <p style="color:blanchedalmond;">You are working on story ID: YoraiElise<br> </p>

    <p style="color:blanchedalmond;">The most recent line in the story is<br> </p>
    <p id="print_last_line" style="color:blanchedalmond;">hi</p>
    <script>get_last_line();</script>



    <form id="input_form">
        <font style="color:blanchedalmond;">Insert new line (click button, do not press enter)<br></font>
        <input name="new_line_input" type="text" size=200>
    </form>
    <button onclick="put_new_line()">
        <font color="grey"> Submit. </font>
    </button>
    <p  style="color:blanchedalmond;"> The submitted line:</p>
    <p id="print_new_line">Waiting for input.</p>


    <br><br>






</body>

</html>
<!-- 
<center><h5>Control A Servo From a Website!!</h5></center>
<input type="submit" value="Angle = 8" onclick="submit(8)">

<div class="slidecontainer">
  <input type="range" min="1" max="180" value="90" class="slider" id="myRange" style="width:600px;">
</div>
<span id="f" style="font-weight:bold;color:red">90</span>
<br>
<input type="button" value="reset angle" style="width:600px;height:5px;"  onclick="submit(90); changeText('f','90'); setSlider('myRange',90)">

<script type="text/javascript">
  var slider = document.getElementById("myRange"); 
  var y = document.getElementById("f");
  y.innerHTML = slider.value;
  slider.oninput = function() {
     y.innerHTML = this.value;  
     var xhr = new XMLHttpRequest();
     xhr.open('get', `https://yorai.scripts.mit.edu/servo/serverServo.py?command=${this.value}`, true);
     xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=UTF-8');
     xhr.send();
  }
</script>

<script type="text/javascript">
    function submit(angle) {
        var xhr = new XMLHttpRequest();
        xhr.open('get', `https://yorai.scripts.mit.edu/servo/serverServo.py?command=${angle}`, true);
        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=UTF-8');
        xhr.send();
    }

</script>

<script>
  //expects strings for both id and newText
  function changeText(id,newText) {
    var element = document.getElementById(id);
    element.innerHTML = newText;
  }
</script>

<script>
  //expects a string for sliderId and int for value
  function setSlider (sliderId, value){
    slider = document.getElementById(sliderId);
    slider.value = value;
  }
</script> -->